Taken from github.com/liuliu/ccv


